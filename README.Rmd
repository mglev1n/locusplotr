---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# locusplotr <img src='man/figures/logo.png' align="right" height="139" />
<!-- badges: start -->
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
[![R-CMD-check](https://github.com/mglev1n/locusplotr/workflows/R-CMD-check/badge.svg)](https://github.com/mglev1n/locusplotr/actions)
<!-- badges: end -->

The goal of `locusplotr` is to allow users to integrate genome-wide association study results with linkage disequilibrium data to create regional association plots surrounding a locus of interest using the `gg_locusplot` function. In the background, this package uses a function named `ld_extract_locuszoom` to query the University of Michigan LocusZoom API (<https://portaldev.sph.umich.edu/>) to obtain linkage disequilibrium data for a genetic variant and genomic region of interest. The `gg_locusplot` function allows the user to provide GWAS summary statistics for a region of interest and a reference variant, and will 1) use the `ld_extract_locuszoom` function to obtain LD information and 2) return a ggplot object with a regional association plot.

## Installation

You can install `locusplotr` from [GitHub](https://github.com/):

``` {r}
# install.packages("devtools")
devtools::install_github("mglev1n/locusplotr")
```

## Usage

Start with a dataframe containing genome wide association study summary statistics at a locus of interest
```{r df_example}
library(locusplotr)

fto_locus_df
```
Use the `gg_locusplot` function to create a regional association plot. This calls the `ld_extract_locuszoom` function in the background to fetch linkage disequilibrium data from the University of Michigan LocusZoom API <https://portaldev.sph.umich.edu/>.

```{r message=FALSE, warning=FALSE, dpi = 600, out.width = '80%', fig.align="center"}
library(tidyverse)

fto_locus_df %>%
  gg_locusplot(
    lead_snp = "rs62033413",
    rsid = rsid,
    chromosome = chromosome,
    position = position,
    ref = effect_allele,
    alt = other_allele,
    p_value = p_value
  )
```

Use the `plot_genes` argument to include a plot of genes within the region beneath the main regional association plot.
```{r message=FALSE, warning=FALSE, dpi = 600, out.width = '80%', fig.align="center"}
gg_locusplot(
  df = fto_locus_df,
  lead_snp = "rs62033413",
  rsid = rsid,
  chromosome = chromosome,
  position = position,
  ref = effect_allele,
  alt = other_allele,
  p_value = p_value,
  plot_genes = TRUE
)
```
